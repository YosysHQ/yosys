read_verilog -sv -defer <<EOT
module sync_ram_sdp #(parameter DATA_WIDTH=8, ADDRESS_WIDTH=8)
   (input  wire                      clk, write_enable, en,
    input  wire  [DATA_WIDTH-1:0]    data_in,
    input  wire  [ADDRESS_WIDTH-1:0] address_in_r, address_in_w,
    output logic [DATA_WIDTH-1:0]    data_out);
   
   localparam NUMWORDS = (DATA_WIDTH-1);
   localparam DEPTH = (2**ADDRESS_WIDTH-1);
   
   logic [NUMWORDS:0] 		     data_out_r;
   logic [NUMWORDS:0] 		     memory [0:DEPTH];
   
   always_ff @(posedge clk) begin
      if (write_enable)
	memory[address_in_w] <= data_in;
      data_out_r <= memory[address_in_r];
      if (en) data_out <= data_out_r;
   end
   
   //assign data_out = data_out_r;
endmodule // sync_ram_sdp

module sync_ram_sdp_noen #(parameter DATA_WIDTH=8, ADDRESS_WIDTH=8)
   (input  wire                      clk, write_enable, en,
    input  wire  [DATA_WIDTH-1:0]    data_in,
    input  wire  [ADDRESS_WIDTH-1:0] address_in_r, address_in_w,
    output logic [DATA_WIDTH-1:0]    data_out);
    sync_ram_sdp #(.DATA_WIDTH(DATA_WIDTH), .ADDRESS_WIDTH(ADDRESS_WIDTH)) u (.*, .en(1'b1));
endmodule
EOT
design -save read


synth_xilinx -noiopad -noclkbuf -top sync_ram_sdp_noen -flatten
cd sync_ram_sdp_noen
select -assert-count 1 t:RAMB18E1
select -assert-none t:FD*
select -assert-none t:RAMB18E1 %% t:* %D


design -load read
synth_xilinx -noiopad -noclkbuf -top sync_ram_sdp
cd sync_ram_sdp
select -assert-count 1 t:RAMB18E1
select -assert-none t:FD*
select -assert-none t:RAMB18E1 %% t:* %D



design -load read
hierarchy -chparam DATA_WIDTH 10 -top sync_ram_sdp
synth_xilinx -noiopad -noclkbuf
cd sync_ram_sdp
select -assert-count 1 t:RAMB18E1
select -assert-none t:FD*
select -assert-none t:RAMB18E1 %% t:* %D


design -load read
hierarchy -chparam DATA_WIDTH 16
synth_xilinx -noiopad -noclkbuf -top sync_ram_sdp
cd sync_ram_sdp
select -assert-count 1 t:RAMB18E1
select -assert-none t:FD*
select -assert-none t:RAMB18E1 %% t:* %D


design -load read
hierarchy -chparam DATA_WIDTH 18
synth_xilinx -noiopad -noclkbuf -top sync_ram_sdp
cd sync_ram_sdp
select -assert-count 1 t:RAMB18E1
select -assert-none t:FD*
select -assert-none t:RAMB18E1 %% t:* %D
